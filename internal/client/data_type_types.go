// Code generated by generate-all-schemas.go. DO NOT EDIT.
// Source: F5 XC OpenAPI specification

package client

import (
	"context"
	"fmt"
)

// DataType represents a F5XC DataType
type DataType struct {
	Metadata Metadata       `json:"metadata"`
	Spec     DataTypeSpec `json:"spec"`
}

// DataTypeSpec defines the specification for DataType
type DataTypeSpec struct {
	Description     string              `json:"description,omitempty"`
	IsPii           bool                `json:"is_pii,omitempty"`
	IsSensitiveData bool                `json:"is_sensitive_data,omitempty"`
	Compliances     []string            `json:"compliances,omitempty"`
	Rules           []DataTypeRuleSpec `json:"rules,omitempty"`
}

// DataTypeRuleSpec defines a data type rule
type DataTypeRuleSpec struct {
	KeyPattern      *DataTypePatternSpec      `json:"key_pattern,omitempty"`
	ValuePattern    *DataTypePatternSpec      `json:"value_pattern,omitempty"`
	KeyValuePattern *DataTypeKeyValuePattern `json:"key_value_pattern,omitempty"`
}

// DataTypePatternSpec defines a pattern for matching
type DataTypePatternSpec struct {
	RegexValue     string                    `json:"regex_value,omitempty"`
	SubstringValue string                    `json:"substring_value,omitempty"`
	ExactValues    *DataTypeExactValuesSpec `json:"exact_values,omitempty"`
}

// DataTypeExactValuesSpec defines exact values to match
type DataTypeExactValuesSpec struct {
	ExactValues []string `json:"exact_values,omitempty"`
}

// DataTypeKeyValuePattern defines a key-value pattern
type DataTypeKeyValuePattern struct {
	KeyPattern   *DataTypePatternSpec `json:"key_pattern,omitempty"`
	ValuePattern *DataTypePatternSpec `json:"value_pattern,omitempty"`
}

// CreateDataType creates a new DataType
func (c *Client) CreateDataType(ctx context.Context, resource *DataType) (*DataType, error) {
	var result DataType
	path := fmt.Sprintf("/api/config/namespaces/%s/data_types", resource.Metadata.Namespace)
	err := c.Post(ctx, path, resource, &result)
	return &result, err
}

// GetDataType retrieves a DataType
func (c *Client) GetDataType(ctx context.Context, namespace, name string) (*DataType, error) {
	var result DataType
	path := fmt.Sprintf("/api/config/namespaces/%s/data_types/%s", namespace, name)
	err := c.Get(ctx, path, &result)
	return &result, err
}

// UpdateDataType updates a DataType
func (c *Client) UpdateDataType(ctx context.Context, resource *DataType) (*DataType, error) {
	var result DataType
	path := fmt.Sprintf("/api/config/namespaces/%s/data_types/%s", resource.Metadata.Namespace, resource.Metadata.Name)
	err := c.Put(ctx, path, resource, &result)
	return &result, err
}

// DeleteDataType deletes a DataType
func (c *Client) DeleteDataType(ctx context.Context, namespace, name string) error {
	path := fmt.Sprintf("/api/config/namespaces/%s/data_types/%s", namespace, name)
	return c.Delete(ctx, path)
}

// DataTypeListResponse is the response from listing data types
type DataTypeListResponse struct {
	Items []DataType `json:"items"`
}

// ListDataTypes lists all data types in a namespace
func (c *Client) ListDataTypes(ctx context.Context, namespace string) ([]DataType, error) {
	var result DataTypeListResponse
	path := fmt.Sprintf("/api/config/namespaces/%s/data_types", namespace)
	err := c.Get(ctx, path, &result)
	if err != nil {
		return nil, err
	}
	return result.Items, nil
}
